# API Gateway Pattern

Imagine you're staying at a fancy hotel. Do you call the kitchen directly for food, the housekeeping for towels, and the valet for your car? No! You call the **concierge** who handles everything for you!

---

## Section 1: What is an API Gateway?

<ApiGatewaySimulator mode="beginner" />

| **Without API Gateway** | **With API Gateway** |
| :--- | :--- |
| Client calls every service directly | Client calls ONE gateway |
| Client needs to know all addresses | Gateway knows where everything is |
| Each service handles authentication | Gateway handles it once |
| Complex for the client | Simple for the client |

<InfoBox type="tip">
  **API Gateway = Hotel Concierge** â€” One person (or service) who directs all your requests to the right place!
</InfoBox>

<ProgressCheckpoint section="ag-what-is-gateway" xpReward={8} />

---

## Section 2: Gateway Features

### 1. Routing (Traffic Cop)
Sends each request to the right service:

```mermaid
flowchart LR
    C1[Client: Products] --> G[API Gateway]
    C2[Client: Orders] --> G
    C3[Client: Payment] --> G
    G --> CS[Catalog Service]
    G --> OS[Order Service]
    G --> PS[Payment Service]
```

### 2. Authentication (Security Guard)
Checks if you're allowed in **before** bothering the services:

```mermaid
sequenceDiagram
    participant C as Client
    participant G as Gateway
    participant S as Services
    C->>G: Here's my ID badge
    G->>G: Validate credentials
    G-->>C: Valid! Come in.
    G->>S: Forward request
    S-->>G: Response
    G-->>C: Response
```

### 3. Rate Limiting (Bouncer)
Prevents too many requests from overwhelming services:

```mermaid
flowchart LR
    C[Client: 100 req/s] --> G{Gateway}
    G -->|Allowed: 10/s| S[Services]
    G -->|Rejected: 90/s| X[429 Too Many Requests]
```

### 4. Request Aggregation (Personal Shopper)
Gets data from multiple services in one call:

```mermaid
sequenceDiagram
    participant C as Client
    participant G as Gateway
    participant U as User Service
    participant O as Order Service
    C->>G: I need profile AND orders
    par Parallel Requests
        G->>U: Get profile
        G->>O: Get orders
    end
    U-->>G: Profile data
    O-->>G: Orders data
    G-->>C: Combined response
```

<ProgressCheckpoint section="ag-gateway-features" xpReward={9} />

---

## Section 3: Implementation Overview

### Without vs With API Gateway

**Without Gateway:**

```mermaid
flowchart LR
    App[Mobile App] --> US[User Service]
    App --> OS[Order Service]
    App --> CS[Catalog Service]
    App --> PS[Payment Service]
```

Problems: App needs 4 different URLs, each service needs its own security

**With Gateway:**

```mermaid
flowchart LR
    App[Mobile App] --> G[API Gateway]
    G --> US[User Service]
    G --> OS[Order Service]
    G --> CS[Catalog Service]
    G --> PS[Payment Service]
```

Benefits: App needs only 1 URL, security handled once

### Real-World Examples

| Gateway | Used By | Purpose |
| :--- | :--- | :--- |
| Amazon API Gateway | AWS | Serverless API management |
| Kong | Many companies | Open-source, plugins |
| Ocelot | .NET apps | Built for .NET microservices |
| NGINX | Everywhere | Web server + gateway |

### Key Takeaways

- **API Gateway = Single entry point** for all client requests
- **Routes** requests to the correct microservice
- **Handles security** so services don't have to
- **Rate limiting** protects services from overload
- Makes life **easier for clients** (like a concierge!)

<ProgressCheckpoint section="ag-implementation" xpReward={8} />
