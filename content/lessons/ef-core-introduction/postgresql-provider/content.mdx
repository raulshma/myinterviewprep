
# PostgreSQL Provider (Npgsql)

PostgreSQL is a powerful, open-source object-relational database system. The `Npgsql.EntityFrameworkCore.PostgreSQL` provider brings the power of Postgres to EF Core developers.

## Installation

Install the Npgsql provider package:

```bash
dotnet add package Npgsql.EntityFrameworkCore.PostgreSQL
```

## Configuration

Configure your `DbContext` to use Npgsql:

```csharp
builder.Services.AddDbContext<ApplicationDbContext>(options =>
    options.UseNpgsql(builder.Configuration.GetConnectionString("DefaultConnection")));
```

<ProgressCheckpoint
  slug="basics"
  options={[
    { id: "correct", label: "UseNpgsql", correct: true },
    { id: "incorrect1", label: "UsePostgres" },
    { id: "incorrect2", label: "UsePostgreSQL" }
  ]}
  question="Which extension method configures the DbContext for PostgreSQL?"
/>

## JSON Support (JSONB)

One of PostgreSQL's strongest features is its robust JSON support. Npgsql allows you to map .NET objects directly to `jsonb` columns.

```csharp
public class Customer
{
    public int Id { get; set; }
    public CustomerDetails Details { get; set; } // Mapped to JSONB
}

public class CustomerDetails
{
    public string Type { get; set; }
    public int Age { get; set; }
}
```

Configuration:

```csharp
modelBuilder.Entity<Customer>()
    .Property(c => c.Details)
    .HasColumnType("jsonb");
```

You can then query into the JSON document:

```csharp
var youngCustomers = context.Customers
    .Where(c => c.Details.Age < 30)
    .ToList();
```

## Arrays and Other Types

Npgsql supports PostgreSQL arrays, allowing you to map `int[]` or `string[]` directly.

```csharp
public class Post
{
    public int Id { get; set; }
    public string[] Tags { get; set; }
}
```

<ProgressCheckpoint
  slug="arrays"
  options={[
    { id: "correct", label: "Native array support (e.g., string[])", correct: true },
    { id: "incorrect1", label: "Only via value converters" },
    { id: "incorrect2", label: "Not supported" }
  ]}
  question="How does Npgsql handle array properties like string[] by default?"
/>

## Differences from SQL Server

- **Case Sensitivity**: Postgres is case-sensitive by default for string comparisons (unless using collations), whereas SQL Server is typically case-insensitive.
- **Identity Columns**: Uses `GENERATED BY DEFAULT AS IDENTITY` in newer versions.

Npgsql is considered one of the most advanced EF Core providers, often exposing features before they become standard in EF Core itself.
